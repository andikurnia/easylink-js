'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_axios=require('axios'),_axios2=_interopRequireDefault(_axios);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var EasyLink=function(){function a(b){var c=b.host,d=b.serialNumber;_classCallCheck(this,a),this.host=c,this.serialNumber=d,this.axios=_axios2.default.create({baseURL:c,headers:{"Content-Type":'application/x-www-form-urlencoded'}})}return _createClass(a,[{key:'generatePayload',value:function d(a){var b=Object.keys(a),c='?';return b.forEach(function(d,e){c+='object'===_typeof(a[d])||Array.isArray(a[d])?d+'='+JSON.stringify(a[d]):d+'='+a[d],e<b.length-1&&(c+='&')}),c}},{key:'getDeviceInfo',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/dev/info'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.data.Result){a.next=8;break}throw new Error('Get device info request failed');case 8:return a.abrupt('return',d.data.DEVINFO);case 11:throw a.prev=11,a.t0=a['catch'](0),a.t0;case 14:case'end':return a.stop();}},a,this,[[0,11]])}));return function b(){return a.apply(this,arguments)}}()},{key:'getAllUsers',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/user/all'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.Result||'string'==typeof d.data.message){a.next=8;break}throw new Error('Get all users request failed');case 8:return a.abrupt('return',Array.isArray(d.data.Data)?d.data.Data:[]);case 11:throw a.prev=11,a.t0=a['catch'](0),a.t0;case 14:case'end':return a.stop();}},a,this,[[0,11]])}));return function b(){return a.apply(this,arguments)}}()},{key:'uploadUser',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c,d,e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c=this.generatePayload(_extends({sn:this.serialNumber},b)),d='/user/set'+c,a.next=5,this.axios.post(d);case 5:if(e=a.sent,e.data.Result){a.next=8;break}throw new Error('Upload user request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()},{key:'deleteAllUsers',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/user/delall'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.data.Result){a.next=8;break}throw new Error('Delete all users request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()},{key:'deleteUser',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c,d,e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c=this.generatePayload({sn:this.serialNumber,pin:b}),d='/user/del'+c,a.next=5,this.axios.post(d);case 5:if(e=a.sent,e.data.Result){a.next=8;break}throw new Error('Delete a user request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()},{key:'getAllScanLogs',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/scanlog/all'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.Result||'string'==typeof d.data.message){a.next=8;break}throw new Error('Get all scanlogs request failed');case 8:return a.abrupt('return',Array.isArray(d.data.Data)?d.data.Data:[]);case 11:throw a.prev=11,a.t0=a['catch'](0),a.t0;case 14:case'end':return a.stop();}},a,this,[[0,11]])}));return function b(){return a.apply(this,arguments)}}()},{key:'getNewScanLogs',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/scanlog/new'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.Result||'string'==typeof d.data.message){a.next=8;break}throw new Error('Get all scanlogs request failed');case 8:return a.abrupt('return',Array.isArray(d.data.Data)?d.data.Data:[]);case 11:throw a.prev=11,a.t0=a['catch'](0),a.t0;case 14:case'end':return a.stop();}},a,this,[[0,11]])}));return function b(){return a.apply(this,arguments)}}()},{key:'deleteAllScanLogs',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/scanlog/del'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.data.Result){a.next=8;break}throw new Error('Delete all scan logs request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()},{key:'syncDateTime',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/dev/settime'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.data.Result){a.next=8;break}throw new Error('Date/time sync request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()},{key:'deleteDeviceLogs',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/log/del'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.data.Result){a.next=8;break}throw new Error('Delete device logs request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()},{key:'init',value:function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,b=this.generatePayload({sn:this.serialNumber}),c='/dev/init'+b,a.next=5,this.axios.post(c);case 5:if(d=a.sent,d.data.Result){a.next=8;break}throw new Error('Init device request failed');case 8:a.next=13;break;case 10:throw a.prev=10,a.t0=a['catch'](0),a.t0;case 13:case'end':return a.stop();}},a,this,[[0,10]])}));return function b(){return a.apply(this,arguments)}}()}]),a}();exports.default=EasyLink;